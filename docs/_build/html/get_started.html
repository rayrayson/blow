

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Getting Started &mdash; Blow 0.5.0 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.5.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="Blow 0.5.0 documentation" href="index.html" />
    <link rel="next" title="Blow configuration" href="conf_main.html" />
    <link rel="prev" title="Overview" href="overview.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="conf_main.html" title="Blow configuration"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="overview.html" title="Overview"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">Blow 0.5.0 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="getting-started">
<h1>Getting Started<a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h1>
<p>This short tutorial shows how configure and run a 5 nodes SGE cluster in the Amazon public clouds.</p>
<p>In this tutorial it is assumed that you have a knowledge of the basic <em>SGE</em> commands. The description
of the <em>SGE</em> resource manager is out of the scope of this manual.</p>
<div class="section" id="download-the-blow-executable-distribution">
<h2>1. Download the <em>Blow</em> executable distribution<a class="headerlink" href="#download-the-blow-executable-distribution" title="Permalink to this headline">¶</a></h2>
<p>The lastest <em>Blow</em> executable distribution is available at <a class="reference external" href="http://dl.dropbox.com/u/376524/blow/blow.jar">this link</a>. Download and
save it somewhere to your machine.</p>
<p>If you a running a *nix system (Linux, Mac OS X, etc.) give the execute permission
to the download <em>JAR</em> file, using the following command:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># chmod +x blow.jar</span>
</pre></div>
</div>
</div>
<div class="section" id="the-configuration-file">
<h2>2. The configuration file<a class="headerlink" href="#the-configuration-file" title="Permalink to this headline">¶</a></h2>
<p>Create a file named <tt class="docutils literal"><span class="pre">blow.conf</span></tt> with the content showed below. Save it in the same directory
where the <tt class="docutils literal"><span class="pre">blow.jar</span></tt> was downloaded.</p>
<div class="highlight-python"><pre>blow_simple_cluster {
  access-key = &lt;replace with your AWS access key&gt;
  secret-key = &lt;replace with your AWS secret key&gt;
  region-id = us-east-1
  zone-id = us-east-1b
  image-id = ami-e565ba8c
  instance-type = t1.micro
  size = 5

  plugin = [
    hosts
    {nfs { path: /soft }}
    {nfs { path: /scratch }}
    {sge { root: /soft/sge6 } }
  ]
}</pre>
</div>
<p>This configuration will deploy a cluster made up of file nodes. It uses the Amazon Linux AMI 2012.03 (x86_64) with ID <tt class="docutils literal"><span class="pre">ami-e565ba8c</span></tt>.</p>
<p>It installs the SGE resource manager in the shared path <tt class="docutils literal"><span class="pre">/soft/sge6</span></tt> and a second shared path named <tt class="docutils literal"><span class="pre">/scratch</span></tt> is created.</p>
</div>
<div class="section" id="launch-the-cluster">
<h2>3. Launch the cluster<a class="headerlink" href="#launch-the-cluster" title="Permalink to this headline">¶</a></h2>
<p>The <em>Blow</em> command needs to be executed using the command line interface. It has the following syntax:</p>
<div class="highlight-python"><pre>blow.jar [blow options] &lt;cluster name&gt; [command name [command parameters] ]</pre>
</div>
<p>If the <em>command</em> is omitted it will run in the <em>interactive</em> mode, waiting for a command to be executed.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Windows users need to launch the <em>Blow</em> application with the <em>Java</em> interpreter. So the above syntax must be replaced
as follows:</p>
<div class="last highlight-python"><pre>java -jar blow.jar [blow options] &lt;cluster name&gt; [command name [command parameters] ]</pre>
</div>
</div>
<p>For the sake of this example start <em>Blow</em> in the interactive mode. Open a terminal window,
move to the directory where the configuration file and the blow executable have been saved and
specify the following command:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># ./blow.jar blow_simple_cluster</span>
</pre></div>
</div>
<p>If a SSH key-pair cannot be found in the current directory or in the <tt class="docutils literal"><span class="pre">$HOME/.ssh/</span></tt> path it will prompt to create a new key pair.
Answer <tt class="docutils literal"><span class="pre">y</span></tt> and press enter to proceed.</p>
<p>When done you will get the <em>Blow</em> prompt as showed below:</p>
<div class="highlight-python"><pre>   ___  __
  / _ )/ /__ _    __
 / _  / / _ \ |/|/ /
/____/_/\___/__,__/  ver: 0.5

blow [blow_simple_cluster] $</pre>
</div>
<p>Before launch the cluster you may verify its configuration entering the <tt class="docutils literal"><span class="pre">conf</span></tt> command on the <em>Blow</em> prompt.
It will result something similar to the output showed below:</p>
<div class="highlight-python"><pre>blow [blow_simple_cluster] $ conf
cluster: blow_simple_cluster
user-name: your-user-name
private-key: ./id_rsa
public-key: ./id_rsa.pub
access-key: AKIAIF3TUNLSJYG5UWQQ
region-id: us-east-1
zone-id: us-east-1b
image-id: ami-e565ba8c
instance-type: t1.micro
size: 5</pre>
</div>
<p>When ready, launch the cluster entering the command <tt class="docutils literal"><span class="pre">start</span></tt>:</p>
<div class="highlight-python"><pre>blow [blow_simple_cluster] $ start</pre>
</div>
<p>It will take some minutes to launch the virtual machines, configure them and install the SGE daemons. When it will complete
your screen will show something similar the following output:</p>
<div class="highlight-python"><pre>blow [blow_simple_cluster] $ start
~ Creating cluster: blow_simple_cluster
~ Creating the 'master' node
~ Creating 4 worker node(s)
~ Configuring hosts file
~ Configuring NFS file system
~ Configuring NFS file system
~ Configuring OpenGridEngine (SGE)
blow [blow_simple_cluster] $</pre>
</div>
<div class="admonition attention">
<p class="first admonition-title">Attention</p>
<p>If the following message is displayed</p>
<p><tt class="docutils literal"><span class="pre">WARN:</span> <span class="pre">Disabling</span> <span class="pre">high-strength</span> <span class="pre">ciphers:</span> <span class="pre">cipher</span> <span class="pre">strengths</span> <span class="pre">apparently</span> <span class="pre">limited</span> <span class="pre">by</span> <span class="pre">JCE</span> <span class="pre">policy</span></tt></p>
<p class="last">you will need to install the <em>Java Cryptography Extension (JCE)</em> for high-strength ciphers.
This is not included by default due to US export restrictions. This is available in the <a class="reference external" href="http://www.oracle.com/technetwork/java/javase/downloads/index.html">Java download</a> at
the bottom of the page.</p>
</div>
</div>
<div class="section" id="access-the-remote-master-node">
<h2>4. Access the remote master node<a class="headerlink" href="#access-the-remote-master-node" title="Permalink to this headline">¶</a></h2>
<p>Use the command <tt class="docutils literal"><span class="pre">listnodes</span></tt> on the <em>Blow</em> prompt to get the list of all running launched nodes in the cluster.
You will get a list similar to the one showed below:</p>
<div class="highlight-python"><pre>blow [blow_simple_cluster] $ listnodes
i-ddd162bb;   23.20.217.171; RUNNING; blow_simple_cluster; master
i-5fd76439;     23.22.43.58; RUNNING; blow_simple_cluster; worker
i-5dd7643b;     23.22.63.20; RUNNING; blow_simple_cluster; worker
i-5bd7643d;    23.20.28.196; RUNNING; blow_simple_cluster; worker
i-59d7643f;    23.20.152.41; RUNNING; blow_simple_cluster; worker</pre>
</div>
<p>Any nodes is accesible using a SSH client. <em>Blow</em> comes with an integrated SSH client.
To connect to a remote node on the prompt just enter the <tt class="docutils literal"><span class="pre">ssh</span></tt> command followed by the IP
address of the node you want to access:</p>
<div class="highlight-python"><pre>ssh 23.20.217.171</pre>
</div>
<div class="admonition attention">
<p class="first admonition-title">Attention</p>
<p class="last">The integrated SSH client manages automatically the access credentials. Using a different
SSH client you will need to specify the user name and identity file (the private key).</p>
</div>
<p>When connected to the remote node, you may want to verify that the <em>SGE</em> scheduler has been
correctly installed. At the shell prompt of the remote system enter the command <tt class="docutils literal"><span class="pre">qhost</span></tt>.
It should print a list of similar to the one showed below:</p>
<div class="highlight-python"><pre>[domU-12-31-38-04-10-03 ~]$ qhost
HOSTNAME                ARCH         NCPU  LOAD  MEMTOT  MEMUSE  SWAPTO  SWAPUS
-------------------------------------------------------------------------------
global                  -               -     -       -       -       -       -
domU-12-31-38-04-10-03  linux-x64       1  0.03  595.4M   49.8M     0.0     0.0
domU-12-31-38-07-4E-06  linux-x64       1  0.04  595.4M   42.8M     0.0     0.0
ip-10-122-83-78         linux-x64       1  0.51  595.4M   50.8M     0.0     0.0
ip-10-122-98-108        linux-x64       1  0.03  595.4M   42.9M     0.0     0.0
ip-10-124-215-153       linux-x64       1  0.03  595.4M   42.8M     0.0     0.0</pre>
</div>
</div>
<div class="section" id="run-a-simple-job-and-terminate-the-cluster">
<h2>5. Run a simple job and terminate the cluster<a class="headerlink" href="#run-a-simple-job-and-terminate-the-cluster" title="Permalink to this headline">¶</a></h2>
<p>Move to the <tt class="docutils literal"><span class="pre">/scratch</span></tt> folder, create a the job script and submit it to the <em>SGE</em> for the execution.
For the sake of this tutorial, you could run these commands:</p>
<div class="highlight-python"><pre>cd /scratch
echo "Hello world!" &gt; test.sh
qsub -cwd -sync y test.sh</pre>
</div>
<p>When the <em>SGE</em> complete the execution of the submitted job, your find the following content in the
current directory:</p>
<div class="highlight-python"><pre>$ ls -la
total 16
drwxr-xr-x  2 ec2-user wheel 4096 May 11 14:15 .
dr-xr-xr-x 26 root     root  4096 May 11 13:59 ..
-rw-r--r--  1 ec2-user wheel   19 May 11 14:14 test.sh
-rw-r--r--  1 ec2-user wheel    0 May 11 14:15 test.sh.e1
-rw-r--r--  1 ec2-user wheel   97 May 11 14:15 test.sh.o1</pre>
</div>
</div>
<div class="section" id="terminate-the-cluster-session">
<h2>6. Terminate the cluster session<a class="headerlink" href="#terminate-the-cluster-session" title="Permalink to this headline">¶</a></h2>
<p>When you have done, don&#8217;t forget to shutdown the cluster and all the running instances.</p>
<p>Log out from the remote node using the <tt class="docutils literal"><span class="pre">exit</span></tt> command and stop the cluster entering the command <tt class="docutils literal"><span class="pre">terminate</span></tt>
on the <em>Blow</em> prompt.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Getting Started</a><ul>
<li><a class="reference internal" href="#download-the-blow-executable-distribution">1. Download the <em>Blow</em> executable distribution</a></li>
<li><a class="reference internal" href="#the-configuration-file">2. The configuration file</a></li>
<li><a class="reference internal" href="#launch-the-cluster">3. Launch the cluster</a></li>
<li><a class="reference internal" href="#access-the-remote-master-node">4. Access the remote master node</a></li>
<li><a class="reference internal" href="#run-a-simple-job-and-terminate-the-cluster">5. Run a simple job and terminate the cluster</a></li>
<li><a class="reference internal" href="#terminate-the-cluster-session">6. Terminate the cluster session</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="overview.html"
                        title="previous chapter">Overview</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="conf_main.html"
                        title="next chapter">Blow configuration</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/get_started.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="conf_main.html" title="Blow configuration"
             >next</a> |</li>
        <li class="right" >
          <a href="overview.html" title="Overview"
             >previous</a> |</li>
        <li><a href="index.html">Blow 0.5.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012, Paolo Di Tommaso.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>